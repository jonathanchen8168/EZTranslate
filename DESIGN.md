Jonathan Chen Design Document for EZtranslate!

I decided to make a chrome extension that is relevant to what I like to do. As someone who is studying Japanese, I wanted to make an extension to make it much easier for me to search for definititions or translations of words. Prior to making this extension, I would need to open up a separate page of the dictionary or translation website, copy the text that I did not know and paste it into the search bar for the website. This extension is meant to streamline this process and make it possible to search for definitions in one step. In the case for searching for Japanese translations and definitions, I like to use jisho.org as it provides clear definitions as well as the audio pronounciation of the words. Because of its ease of use and clarity I decided to use jisho.org as my website that I search definitions for. Since jisho.org already has its own search system I was able to utilize it to search for the translations and definitions of words in both English and Japanese. I decided to have the extension open a window to the website as the design of the page is very clear and also displays multiple different word contexts of what the highlighted word could be as well as links to other resources on the webpage such as the audio pronounciation and sentence usage.

To start off I needed to learn how to create a Chrome extension as I had no prior knowledge. Chrome extensions used primarily javascript to run its functions with HTML and CSS when separate pages are needed. I needed to learn more about javascript as I only had some knowledge from previous problem sets that I worked on. The most important part of a Chrome extension which acts as the structure of the extension is the manifest.json file. I learned that this file is what lets Chrome know what other files were included i the extension and what websites it can be run on. The background script and content scripts needed to be specified as well as the images for the extension in the manifest.json file. Because I wanted the extension to work on all pages and websites, I needed to make sure that it had permissions to work on all pages and websites with browser_action type extension instead of a page_action. Browser_action means that the extension button will always be running while page_action means that it will only be active on certain pages. I also needed to make sure that the content script runs on all urls by makes sure it matches all urls.

Afterwards, I then needed to figure out how to have the user input the words that the user wanted. I decided that getting the text that the user highlights makes the most sense as to copy and paste text the user would need to highlight the text first. I learned that there are multiple scripts that ran when a chrome extension is used. The background script is run in the background as the name suggests when the browser is launched meaning that this script will start being active whenever the browser is used. While the content script is only run on specified pages in which this case is all urls. To get the information on the page, I needed to utilize the content script to grab the information.

To get the information on the page and send it to the background script I needed to first grab what was higlighted then have that information transfered. I decided to create a console log to let me know that the content script was running properly. I then created a function that would take what was highlighted and store it in a string variable. I then created another console log to let me know what the highlighted word was. Then I then stored the word variable to another variable to have it ready to be sent. I learned that Chrome has a function that lets you have the content script communicate with the background script with chrome.runtime.sendMessage() and whatever the message you wanted to send inside the parentheses. After creating the function that allows the text highlighted to be stored and sent, I learned that there were listeners that would activate on a certain event. I decided to use the "mouseup" event as that would be when the mouse is released to select the text and then it executes the function to store the selected word and send it to the background script.

In the background.js background script, I start out with a console log to let me know that the background script is running. I then needed to create a function that would get the data of the highlighted text from the content script. In the reciever function it takes the requested id of highlightword, logs in the console of the background what the word is and then stores the text portion of the message in a variable. With chrome.runtime.onMessage.addListener(receiver), it lets the background script which is already running constantly listen for when the message is sent to then store the highlighted text in a variable. I then create another function that takes the information and creates a search for the definition. I first create a new variable that includes the search url and combine it with the highlighted text variable at the end to create a new url address. Then with the Chrome functions, I create a new window with the new url in a popup type window and create a console log of the word when the popup is run. I then needed to have the functions activate when the extension icon is clicked. So with the Chrome browserAction function I have it to listen when the button is clicked to run. Inside this function I have it where only when there is something selected the popup function would run. Otherwise nothing would happen. Finally, the extension was able to work but it still was unintuitive to only have it possible to click the icon as it would require moving the mouse across the screen. I needed then to learn how to create an item in the context menu when the selected text is right clicked. To create the context menu item, I needed to create a unique id for the item, a title for the text that appears on the menu as well as context to when the item is selected. Afterwards I then created the context menu with those attributes. I then added a listener function for when the item is clicked to run. I added a check to make sure the correct menu item is selected with the id to then run the popup function which opens a new window to the translation of the selected words.

Due to time constraints there were some features that I needed to cut that were incomplete due to issues that I ran into. Originally in the best version of the extension, I wanted the user to be able to select from various sources what translations were provided. For example, I wanted to add the capability to switch from not just a Japanese translation source but also a Chinese translation source or even just word definitions for English. I also wanted to create a page which kept track a list of what words the user had searched so it would be easy for the user to go back and study the words. I also wanted the user to be able to export the table of words, clear the table of words, or remove specific items from the table of words. I also wanted the tables to fill dynamically with each time the user searches for a word to add onto the list. However, I ran into some issues that prevented this function to work properly. The first major issue was that whenever the browser was closed or the window for the saved word list page was closed, the information would not be saved. This lead to each session becoming a new session for the saved words page meaning the history of the words was not saved. Whenever I refreshed the saved words list page, it would create a new session wiping out the list of words previously selected. Chrome does have the capability to store the words with the chrome.storage api but the data is stored asynchronously and I was unable to figure out how to utilize this properly within the time constraint. I was unsure with how the order of operations for how the data is saved since it is stored asynchronously insted of synchronized storage. Another issue that I ran into was that I was having difficulty transfering the information from the background script to the saved words page script to create a table of the words and the links to the definitions. I was unable to figure out how to properly transfer the information a second time from the background script to the saved words list script this prevented me from filling out the tables dynamically with a list of all the words. With these issues, I ultimately had to cut these features from the extension to fit within the time constraint.

I learned a lot while working on this project. Before starting, I had zero knowledge about how to create a Chrome extension and how they worked. I also did not have much experience with working in javascript making this project a challenging task. Throughout this project I was able to learn the inner mechanics of building a chrome extension as well as how to utilize javascript better. This project, although quite challenging, was very enjoyable as I was able to create a program that benefitted my everyday life.